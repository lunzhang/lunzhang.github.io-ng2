"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require('@angular/core');
var widget_1 = require('../widget/widget');
var widgetshadow_1 = require('../widgetshadow/widgetshadow');
var NgGrid = (function () {
    function NgGrid() {
        this.onDragStart = new core_1.EventEmitter();
        this.onDrag = new core_1.EventEmitter();
        this.onDragStop = new core_1.EventEmitter();
        this.onResizeStart = new core_1.EventEmitter();
        this.onResize = new core_1.EventEmitter();
        this.onResizeStop = new core_1.EventEmitter();
        this.gridStyle = {
            'position': 'relative',
            '-webkit-touch-callout': 'none',
            '-webkit-user-select': 'none',
            '-khtml-user-select': 'none',
            '-moz-user-select': 'none',
            '-ms-user-select': 'none',
            'user-select': 'none'
        };
        this.gridConfig = {
            'maxCol': 5,
            'maxRow': 5,
            'theme': 'light',
            'colWidth': 250,
            'rowHeight': 180,
            'marginLeft': 10,
            'marginTop': 10,
            'marginRight': 10,
            'marginBottom': 10,
            'minWidth': 1,
            'minHeight': 1,
            'maxWidth': -1,
            'maxHeight': -1
        };
        this.widgets = [];
        this.windowScroll = {
            x: 0,
            y: 0
        };
    }
    NgGrid.prototype.ngOnInit = function () {
        for (var config in this.customConfig) {
            this.gridConfig[config] = this.customConfig[config];
        }
    };
    NgGrid.prototype.onMouseDown = function (e) {
    };
    NgGrid.prototype.onMouseMove = function (e) {
        if (this.activeWidget) {
            if (this.activeWidget.isDrag) {
                this.onDrag.emit(this.activeWidget);
                var dx = e.clientX - this.activeWidget.mousePoint.x;
                var dy = e.clientY - this.activeWidget.mousePoint.y;
                var gridPos = this._getPosition();
                if (this.ngWidgetShadow.position.row != gridPos.row || this.ngWidgetShadow.position.col != gridPos.col) {
                    this._checkCollision(gridPos, this.activeWidget.size, this.activeWidget.id);
                    this.ngWidgetShadow.setPosition(gridPos);
                    this._calcGridSize();
                }
                if (this.activeWidget.style.top > 0 || dy > 0) {
                    this.activeWidget.style.top = this.activeWidget.style.top + dy > 0 ? this.activeWidget.style.top + dy : 0;
                    this.activeWidget.mousePoint.y = e.clientY;
                }
                if (this.activeWidget.style.left > 0 || dx > 0) {
                    this.activeWidget.style.left = this.activeWidget.style.left + dx > 0 ? this.activeWidget.style.left + dx : 0;
                    this.activeWidget.mousePoint.x = e.clientX;
                }
            }
            else if (this.activeWidget.isResize) {
                this.onResize.emit(this.activeWidget);
                var dx = e.clientX - this.activeWidget.mousePoint.x;
                var dy = e.clientY - this.activeWidget.mousePoint.y;
                var size = this._getSize();
                if (this.ngWidgetShadow.size.x != size.x || this.ngWidgetShadow.size.y != size.y) {
                    this._checkCollision(this.activeWidget.position, size, this.activeWidget.id);
                    this.ngWidgetShadow.setSize(size);
                    this._calcGridSize();
                }
                if (this.activeWidget.style.height + dy >= this.gridConfig.minHeight * this.gridConfig.rowHeight) {
                    if (this.gridConfig.maxHeight == -1 || this.activeWidget.style.height + dy <= this.gridConfig.maxHeight * this.gridConfig.rowHeight + this.gridConfig.marginTop) {
                        this.activeWidget.style.height += dy;
                        this.activeWidget.mousePoint.y = e.clientY;
                    }
                    else {
                        this.activeWidget.style.height = this.gridConfig.maxHeight * this.gridConfig.rowHeight + this.gridConfig.marginTop;
                    }
                }
                else {
                    this.activeWidget.style.height = this.gridConfig.minHeight * this.gridConfig.rowHeight;
                }
                if (this.activeWidget.style.width + dx >= this.gridConfig.minWidth * this.gridConfig.colWidth) {
                    if (this.gridConfig.maxWidth == -1 || this.activeWidget.style.width + dx <= this.gridConfig.maxWidth * this.gridConfig.colWidth + this.gridConfig.marginLeft) {
                        this.activeWidget.style.width += dx;
                        this.activeWidget.mousePoint.x = e.clientX;
                    }
                    else {
                        this.activeWidget.style.width = this.gridConfig.maxWidth * this.gridConfig.colWidth + this.gridConfig.marginLeft;
                    }
                }
                else {
                    this.activeWidget.style.width = this.gridConfig.minWidth * this.gridConfig.colWidth;
                }
            }
        }
    };
    NgGrid.prototype.onMouseUp = function (e) {
        if (this.activeWidget) {
            if (this.activeWidget.isDrag) {
                this.onDragStop.emit(this.activeWidget);
                this.activeWidget.setPosition(this.ngWidgetShadow.position);
                this._findWidgetById(this.activeWidget.id).position = this.ngWidgetShadow.position;
                this._calcGridSize();
            }
            else if (this.activeWidget.isResize) {
                this.onResizeStop.emit(this.activeWidget);
                this.activeWidget.setSize(this.ngWidgetShadow.size);
                this._findWidgetById(this.activeWidget.id).size = this.ngWidgetShadow.size;
                this._calcGridSize();
            }
            this.ngWidgetShadow.deactivate();
            this.activeWidget.reset();
            this.activeWidget = null;
        }
    };
    NgGrid.prototype.onScroll = function (e) {
        if (this.activeWidget) {
            if (this.activeWidget.isDrag) {
                var dx = window.scrollX - this.windowScroll.x;
                var dy = window.scrollY - this.windowScroll.y;
                var gridPos = this._getPosition();
                if (this.ngWidgetShadow.position.row != gridPos.row || this.ngWidgetShadow.position.col != gridPos.col) {
                    this._checkCollision(gridPos, this.activeWidget.size, this.activeWidget.id);
                    this.ngWidgetShadow.setPosition(gridPos);
                    this._calcGridSize();
                }
                if (this.activeWidget.style.top > 0 || dy > 0) {
                    this.activeWidget.style.top = this.activeWidget.style.top + dy > 0 ? this.activeWidget.style.top + dy : 0;
                }
                if (this.activeWidget.style.left > 0 || dx > 0) {
                    this.activeWidget.style.left = this.activeWidget.style.left + dx > 0 ? this.activeWidget.style.left + dx : 0;
                }
            }
        }
        this.windowScroll.x = window.scrollX;
        this.windowScroll.y = window.scrollY;
    };
    NgGrid.prototype.onActivateWidget = function (widget) {
        if (widget.isDrag) {
            this.onDragStart.emit(widget);
        }
        else if (widget.isResize) {
            this.onResizeStart.emit(widget);
        }
        this.ngWidgetShadow.activate();
        this.ngWidgetShadow.setPosition(widget.position);
        this.ngWidgetShadow.setSize(widget.size);
        this.activeWidget = widget;
    };
    NgGrid.prototype.onClose = function (widget) {
        for (var i = 0; i < this.widgets.length; i++) {
            if (this.widgets[i].id == widget.id) {
                this.widgets.splice(i, 1);
            }
        }
    };
    NgGrid.prototype.addWidget = function () {
        function guid() {
            function s4() {
                return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
            }
            return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
        }
        var emptyCol = this._findEmptyCol();
        var newWidget = {
            id: guid(),
            position: {
                'col': emptyCol,
                'row': 1
            },
            size: {
                'x': 1,
                'y': 1
            }
        };
        this.widgets.push(newWidget);
        this._calcGridSize();
        return newWidget;
    };
    NgGrid.prototype.empty = function () {
        this.widgets = [];
    };
    NgGrid.prototype._getPosition = function () {
        var col = Math.round(this.activeWidget.style.left / (this.gridConfig.colWidth + this.gridConfig.marginLeft / 2)) + 1;
        var row = Math.round(this.activeWidget.style.top / (this.gridConfig.rowHeight + this.gridConfig.marginTop / 2)) + 1;
        return { 'col': col, 'row': row };
    };
    NgGrid.prototype._getSize = function () {
        var x = Math.round(this.activeWidget.style.width / (this.gridConfig.colWidth + this.gridConfig.marginLeft / 2));
        var y = Math.round(this.activeWidget.style.height / (this.gridConfig.rowHeight + this.gridConfig.marginTop / 2));
        return { 'x': x, 'y': y };
    };
    NgGrid.prototype._getMousePosition = function (e) {
        var refPos = this.grid.nativeElement.getBoundingClientRect();
        var left = e.clientX - refPos.left;
        var top = e.clientY - refPos.top;
        return {
            left: left,
            top: top
        };
    };
    NgGrid.prototype._findNgWidgetById = function (id) {
        for (var i = 0; i < this.ngWidgets.length; i++) {
            if (this.ngWidgets[i].id == id) {
                return this.ngWidgets[i];
            }
        }
    };
    NgGrid.prototype._findWidgetById = function (id) {
        for (var i = 0; i < this.widgets.length; i++) {
            if (this.widgets[i].id == id) {
                return this.widgets[i];
            }
        }
    };
    NgGrid.prototype._findEmptyCol = function () {
        var col = 0;
        this.widgets.forEach(function (widget) {
            if (widget.position.col > col)
                col = widget.position.col;
        });
        return col + 1;
    };
    NgGrid.prototype._getCollision = function (position, size, id) {
        var _this = this;
        var collisions = [];
        this.ngWidgets.forEach(function (widget) {
            if (widget.id != id && widget.id != _this.activeWidget.id) {
                if (((widget.position.col >= position.col && widget.position.col < position.col + size.x)
                    || (widget.position.col + widget.size.x - 1 >= position.col && widget.position.col + widget.size.x - 1 < position.col + size.x)
                    || (position.col >= widget.position.col && position.col < widget.position.col + widget.size.x))
                    && ((widget.position.row >= position.row && widget.position.row < position.row + size.y)
                        || (widget.position.row + widget.size.y - 1 >= position.row && widget.position.row + widget.size.y - 1 < position.row + size.y)
                        || (position.row >= widget.position.row && position.row < widget.position.row + widget.size.y))) {
                    collisions.push(widget);
                }
            }
        });
        return collisions;
    };
    NgGrid.prototype._checkCollision = function (position, size, id) {
        var _this = this;
        var collisions = this._getCollision(position, size, id);
        collisions.forEach(function (widget) {
            widget.position.row = position.row + size.y;
            widget.calcPosition();
            _this._checkCollision(widget.position, widget.size, widget.id);
        });
    };
    NgGrid.prototype._calcGridSize = function () {
        var maxRow = this.gridConfig.maxRow;
        var maxCol = this.gridConfig.maxCol;
        this.widgets.forEach(function (widget) {
            if ((widget.position.col + widget.size.x - 1) > maxCol)
                maxCol = widget.position.col + widget.size.x - 1;
            if ((widget.position.row + widget.size.y - 1) > maxRow)
                maxRow = widget.position.row + widget.size.y - 1;
        });
        if ((this.ngWidgetShadow.position.col + this.ngWidgetShadow.size.x - 1) > maxCol)
            maxCol = this.ngWidgetShadow.position.col + this.ngWidgetShadow.size.x - 1;
        if ((this.ngWidgetShadow.position.row + this.ngWidgetShadow.size.y - 1) > maxRow)
            maxRow = this.ngWidgetShadow.position.row + this.ngWidgetShadow.size.y - 1;
        this.gridStyle.width = (maxCol * (this.gridConfig.colWidth + 2)) + (maxCol * this.gridConfig.marginLeft)
            + this.gridConfig.marginRight;
        this.gridStyle.height = (maxRow * (this.gridConfig.rowHeight + 2)) + (maxRow * this.gridConfig.marginTop)
            + this.gridConfig.marginBottom;
    };
    __decorate([
        core_1.Output(), 
        __metadata('design:type', core_1.EventEmitter)
    ], NgGrid.prototype, "onDragStart", void 0);
    __decorate([
        core_1.Output(), 
        __metadata('design:type', core_1.EventEmitter)
    ], NgGrid.prototype, "onDrag", void 0);
    __decorate([
        core_1.Output(), 
        __metadata('design:type', core_1.EventEmitter)
    ], NgGrid.prototype, "onDragStop", void 0);
    __decorate([
        core_1.Output(), 
        __metadata('design:type', core_1.EventEmitter)
    ], NgGrid.prototype, "onResizeStart", void 0);
    __decorate([
        core_1.Output(), 
        __metadata('design:type', core_1.EventEmitter)
    ], NgGrid.prototype, "onResize", void 0);
    __decorate([
        core_1.Output(), 
        __metadata('design:type', core_1.EventEmitter)
    ], NgGrid.prototype, "onResizeStop", void 0);
    __decorate([
        core_1.ViewChild('grid'), 
        __metadata('design:type', Object)
    ], NgGrid.prototype, "grid", void 0);
    __decorate([
        core_1.ViewChildren(widget_1.NgWidget), 
        __metadata('design:type', core_1.QueryList)
    ], NgGrid.prototype, "ngWidgets", void 0);
    __decorate([
        core_1.ViewChild(widgetshadow_1.NgWidgetShadow), 
        __metadata('design:type', Object)
    ], NgGrid.prototype, "ngWidgetShadow", void 0);
    __decorate([
        core_1.Input(), 
        __metadata('design:type', Object)
    ], NgGrid.prototype, "customConfig", void 0);
    __decorate([
        core_1.HostListener('mousedown', ['$event']), 
        __metadata('design:type', Function), 
        __metadata('design:paramtypes', [Object]), 
        __metadata('design:returntype', void 0)
    ], NgGrid.prototype, "onMouseDown", null);
    __decorate([
        core_1.HostListener('mousemove', ['$event']), 
        __metadata('design:type', Function), 
        __metadata('design:paramtypes', [Object]), 
        __metadata('design:returntype', void 0)
    ], NgGrid.prototype, "onMouseMove", null);
    __decorate([
        core_1.HostListener('mouseup', ['$event']), 
        __metadata('design:type', Function), 
        __metadata('design:paramtypes', [Object]), 
        __metadata('design:returntype', void 0)
    ], NgGrid.prototype, "onMouseUp", null);
    __decorate([
        core_1.HostListener('window:scroll', ['$event']), 
        __metadata('design:type', Function), 
        __metadata('design:paramtypes', [Object]), 
        __metadata('design:returntype', void 0)
    ], NgGrid.prototype, "onScroll", null);
    NgGrid = __decorate([
        core_1.Component({
            moduleId: module.id,
            selector: 'grid',
            template: '<div #grid [ngStyle]="gridStyle" class="grid" [ngClass]="gridConfig.theme"> <widget-shadow [gridConfig]="gridConfig" > </widget-shadow>' +
                '<widget *ngFor="let widget of widgets" (onActivateWidget)="onActivateWidget($event)" (onClose)="onClose($event)" ' +
                '[id]="widget.id" [content]="widget.content" [position]="widget.position" [widgetTitle]="widget.widgetTitle" [gridConfig]="gridConfig" > </widget> </div>',
            styleUrls: ['./grid.css']
        }), 
        __metadata('design:paramtypes', [])
    ], NgGrid);
    return NgGrid;
}());
exports.NgGrid = NgGrid;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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Qyw2QkFBYyxDQUFDOztrREFBQTtJQUUxQjtRQUFDLFlBQUssRUFBRTs7Z0RBQUE7SUF1Q1I7UUFBQyxtQkFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDOzs7OzZDQUFBO0lBSXRDO1FBQUMsbUJBQVksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQzs7Ozs2Q0FBQTtJQTBEdEM7UUFBQyxtQkFBWSxDQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDOzs7OzJDQUFBO0lBb0JwQztRQUFDLG1CQUFZLENBQUMsZUFBZSxFQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7Ozs7MENBQUE7SUE5STNDO1FBQUMsZ0JBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRTtZQUNuQixRQUFRLEVBQUUsTUFBTTtZQUNkLFFBQVEsRUFBRSx5SUFBeUk7Z0JBQ25KLG1IQUFtSDtnQkFDbkgsMEpBQTBKO1lBQzFKLFNBQVMsRUFBQyxDQUFDLFlBQVksQ0FBQztTQUMzQixDQUFDOztjQUFBO0lBbVRGLGFBQUM7QUFBRCxDQWxUQSxBQWtUQyxJQUFBO0FBbFRZLGNBQU0sU0FrVGxCLENBQUEiLCJmaWxlIjoiZ3JpZC9ncmlkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LEhvc3RMaXN0ZW5lcixWaWV3Q2hpbGQsVmlld0NoaWxkcmVuLElucHV0LE91dHB1dCxFdmVudEVtaXR0ZXIsT25Jbml0LFF1ZXJ5TGlzdH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE5nV2lkZ2V0IH0gZnJvbSAnLi4vd2lkZ2V0L3dpZGdldCc7XHJcbmltcG9ydCB7IE5nV2lkZ2V0U2hhZG93IH0gZnJvbSAnLi4vd2lkZ2V0c2hhZG93L3dpZGdldHNoYWRvdyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBtb2R1bGVJZDogbW9kdWxlLmlkLFxyXG4gIHNlbGVjdG9yOiAnZ3JpZCcsXHJcbiAgICB0ZW1wbGF0ZTogJzxkaXYgI2dyaWQgW25nU3R5bGVdPVwiZ3JpZFN0eWxlXCIgY2xhc3M9XCJncmlkXCIgW25nQ2xhc3NdPVwiZ3JpZENvbmZpZy50aGVtZVwiPiA8d2lkZ2V0LXNoYWRvdyBbZ3JpZENvbmZpZ109XCJncmlkQ29uZmlnXCIgPiA8L3dpZGdldC1zaGFkb3c+JytcclxuICAgICc8d2lkZ2V0ICpuZ0Zvcj1cImxldCB3aWRnZXQgb2Ygd2lkZ2V0c1wiIChvbkFjdGl2YXRlV2lkZ2V0KT1cIm9uQWN0aXZhdGVXaWRnZXQoJGV2ZW50KVwiIChvbkNsb3NlKT1cIm9uQ2xvc2UoJGV2ZW50KVwiICcrXHJcbiAgICAnW2lkXT1cIndpZGdldC5pZFwiIFtjb250ZW50XT1cIndpZGdldC5jb250ZW50XCIgW3Bvc2l0aW9uXT1cIndpZGdldC5wb3NpdGlvblwiIFt3aWRnZXRUaXRsZV09XCJ3aWRnZXQud2lkZ2V0VGl0bGVcIiBbZ3JpZENvbmZpZ109XCJncmlkQ29uZmlnXCIgPiA8L3dpZGdldD4gPC9kaXY+JyxcclxuICAgIHN0eWxlVXJsczpbJy4vZ3JpZC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTmdHcmlkIGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQE91dHB1dCgpIHB1YmxpYyBvbkRyYWdTdGFydDogRXZlbnRFbWl0dGVyPE5nV2lkZ2V0PiA9IG5ldyBFdmVudEVtaXR0ZXI8TmdXaWRnZXQ+KCk7XHJcblx0QE91dHB1dCgpIHB1YmxpYyBvbkRyYWc6IEV2ZW50RW1pdHRlcjxOZ1dpZGdldD4gPSBuZXcgRXZlbnRFbWl0dGVyPE5nV2lkZ2V0PigpO1xyXG5cdEBPdXRwdXQoKSBwdWJsaWMgb25EcmFnU3RvcDogRXZlbnRFbWl0dGVyPE5nV2lkZ2V0PiA9IG5ldyBFdmVudEVtaXR0ZXI8TmdXaWRnZXQ+KCk7XHJcblx0QE91dHB1dCgpIHB1YmxpYyBvblJlc2l6ZVN0YXJ0OiBFdmVudEVtaXR0ZXI8TmdXaWRnZXQ+ID0gbmV3IEV2ZW50RW1pdHRlcjxOZ1dpZGdldD4oKTtcclxuXHRAT3V0cHV0KCkgcHVibGljIG9uUmVzaXplOiBFdmVudEVtaXR0ZXI8TmdXaWRnZXQ+ID0gbmV3IEV2ZW50RW1pdHRlcjxOZ1dpZGdldD4oKTtcclxuXHRAT3V0cHV0KCkgcHVibGljIG9uUmVzaXplU3RvcDogRXZlbnRFbWl0dGVyPE5nV2lkZ2V0PiA9IG5ldyBFdmVudEVtaXR0ZXI8TmdXaWRnZXQ+KCk7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2dyaWQnKSBncmlkO1xyXG4gIEBWaWV3Q2hpbGRyZW4oTmdXaWRnZXQpIG5nV2lkZ2V0cyA6IFF1ZXJ5TGlzdDxOZ1dpZGdldD47XHJcbiAgQFZpZXdDaGlsZChOZ1dpZGdldFNoYWRvdykgbmdXaWRnZXRTaGFkb3c7XHJcblxyXG4gIEBJbnB1dCgpIGN1c3RvbUNvbmZpZzphbnk7XHJcblxyXG4gIHB1YmxpYyBncmlkU3R5bGU6YW55PSB7XHJcbiAgICAncG9zaXRpb24nOidyZWxhdGl2ZScsXHJcbiAgICAnLXdlYmtpdC10b3VjaC1jYWxsb3V0JzogJ25vbmUnLFxyXG4gICAgJy13ZWJraXQtdXNlci1zZWxlY3QnOiAnbm9uZScsXHJcbiAgICAgJy1raHRtbC11c2VyLXNlbGVjdCc6ICdub25lJyxcclxuICAgICAgICctbW96LXVzZXItc2VsZWN0JzogJ25vbmUnLFxyXG4gICAgICAgICctbXMtdXNlci1zZWxlY3QnOiAnbm9uZScsXHJcbiAgICAgICAgICAgICd1c2VyLXNlbGVjdCc6ICdub25lJ1xyXG4gIH07XHJcbiAgcHVibGljIGdyaWRDb25maWc6YW55PXtcclxuICAgICdtYXhDb2wnOjUsXHJcbiAgICAnbWF4Um93Jzo1LFxyXG4gICAgJ3RoZW1lJzonbGlnaHQnLFxyXG4gICAgJ2NvbFdpZHRoJzoyNTAsXHJcbiAgICAncm93SGVpZ2h0JzoxODAsXHJcbiAgICAnbWFyZ2luTGVmdCc6MTAsXHJcbiAgICAnbWFyZ2luVG9wJzoxMCxcclxuICAgICdtYXJnaW5SaWdodCc6MTAsXHJcbiAgICAnbWFyZ2luQm90dG9tJzoxMCxcclxuICAgICdtaW5XaWR0aCc6MSxcclxuICAgICdtaW5IZWlnaHQnOjEsXHJcbiAgICAnbWF4V2lkdGgnOi0xLFxyXG4gICAgJ21heEhlaWdodCc6LTFcclxuICB9O1xyXG4gIHB1YmxpYyBhY3RpdmVXaWRnZXQ6TmdXaWRnZXQ7XHJcbiAgcHVibGljIHdpZGdldHM9W107XHJcbiAgcHVibGljIHdpbmRvd1Njcm9sbDphbnk9e1xyXG4gICAgeDowLFxyXG4gICAgeTowXHJcbiAgfTtcclxuXHJcbiAgbmdPbkluaXQoKXtcclxuICAgIGZvcih2YXIgY29uZmlnIGluIHRoaXMuY3VzdG9tQ29uZmlnKXtcclxuICAgICAgdGhpcy5ncmlkQ29uZmlnW2NvbmZpZ10gPSB0aGlzLmN1c3RvbUNvbmZpZ1tjb25maWddO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQEhvc3RMaXN0ZW5lcignbW91c2Vkb3duJywgWyckZXZlbnQnXSlcclxuICBvbk1vdXNlRG93bihlKXtcclxuICB9XHJcblxyXG4gIEBIb3N0TGlzdGVuZXIoJ21vdXNlbW92ZScsIFsnJGV2ZW50J10pXHJcbiAgb25Nb3VzZU1vdmUoZSl7XHJcbiAgICAgIGlmKHRoaXMuYWN0aXZlV2lkZ2V0KXtcclxuICAgICAgICBpZih0aGlzLmFjdGl2ZVdpZGdldC5pc0RyYWcpe1xyXG4gICAgICAgICAgdGhpcy5vbkRyYWcuZW1pdCh0aGlzLmFjdGl2ZVdpZGdldCk7XHJcbiAgICAgICAgICBsZXQgZHggPSBlLmNsaWVudFggLSB0aGlzLmFjdGl2ZVdpZGdldC5tb3VzZVBvaW50Lng7XHJcbiAgICAgICAgICBsZXQgZHkgPSBlLmNsaWVudFkgLSB0aGlzLmFjdGl2ZVdpZGdldC5tb3VzZVBvaW50Lnk7XHJcbiAgICAgICAgICBsZXQgZ3JpZFBvcyA9IHRoaXMuX2dldFBvc2l0aW9uKCk7XHJcblxyXG4gICAgICAgICAgaWYodGhpcy5uZ1dpZGdldFNoYWRvdy5wb3NpdGlvbi5yb3cgIT0gZ3JpZFBvcy5yb3cgfHwgdGhpcy5uZ1dpZGdldFNoYWRvdy5wb3NpdGlvbi5jb2wgIT0gZ3JpZFBvcy5jb2wpe1xyXG4gICAgICAgICAgICAgIHRoaXMuX2NoZWNrQ29sbGlzaW9uKGdyaWRQb3MsdGhpcy5hY3RpdmVXaWRnZXQuc2l6ZSx0aGlzLmFjdGl2ZVdpZGdldC5pZCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5uZ1dpZGdldFNoYWRvdy5zZXRQb3NpdGlvbihncmlkUG9zKTtcclxuICAgICAgICAgICAgICB0aGlzLl9jYWxjR3JpZFNpemUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmKHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLnRvcCA+IDAgfHwgZHkgPiAwKXtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUudG9wID0gdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUudG9wICsgZHkgPiAwID8gdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUudG9wICsgZHkgOiAwO1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVdpZGdldC5tb3VzZVBvaW50LnkgPSBlLmNsaWVudFk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZih0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS5sZWZ0ID4gMCB8fCBkeCA+IDApe1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS5sZWZ0ID0gdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUubGVmdCArIGR4ID4gMCA/IHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLmxlZnQgKyBkeCA6IDA7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlV2lkZ2V0Lm1vdXNlUG9pbnQueCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYodGhpcy5hY3RpdmVXaWRnZXQuaXNSZXNpemUpe1xyXG4gICAgICAgICAgdGhpcy5vblJlc2l6ZS5lbWl0KHRoaXMuYWN0aXZlV2lkZ2V0KTtcclxuICAgICAgICAgIGxldCBkeCA9IGUuY2xpZW50WCAtIHRoaXMuYWN0aXZlV2lkZ2V0Lm1vdXNlUG9pbnQueDtcclxuICAgICAgICAgIGxldCBkeSA9IGUuY2xpZW50WSAtIHRoaXMuYWN0aXZlV2lkZ2V0Lm1vdXNlUG9pbnQueTtcclxuICAgICAgICAgIGxldCBzaXplID0gdGhpcy5fZ2V0U2l6ZSgpO1xyXG5cclxuICAgICAgICAgIGlmKHRoaXMubmdXaWRnZXRTaGFkb3cuc2l6ZS54ICE9IHNpemUueCB8fCB0aGlzLm5nV2lkZ2V0U2hhZG93LnNpemUueSAhPSBzaXplLnkpe1xyXG4gICAgICAgICAgICB0aGlzLl9jaGVja0NvbGxpc2lvbih0aGlzLmFjdGl2ZVdpZGdldC5wb3NpdGlvbixzaXplLHRoaXMuYWN0aXZlV2lkZ2V0LmlkKVxyXG4gICAgICAgICAgICB0aGlzLm5nV2lkZ2V0U2hhZG93LnNldFNpemUoc2l6ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbGNHcmlkU2l6ZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYodGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUuaGVpZ2h0ICsgZHkgPj0gdGhpcy5ncmlkQ29uZmlnLm1pbkhlaWdodCAqIHRoaXMuZ3JpZENvbmZpZy5yb3dIZWlnaHQpe1xyXG4gICAgICAgICAgICBpZih0aGlzLmdyaWRDb25maWcubWF4SGVpZ2h0ID09IC0xIHx8IHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLmhlaWdodCArIGR5IDw9IHRoaXMuZ3JpZENvbmZpZy5tYXhIZWlnaHQgKiB0aGlzLmdyaWRDb25maWcucm93SGVpZ2h0ICsgdGhpcy5ncmlkQ29uZmlnLm1hcmdpblRvcCl7XHJcbiAgICAgICAgICAgICAgdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUuaGVpZ2h0ICs9IGR5O1xyXG4gICAgICAgICAgICAgIHRoaXMuYWN0aXZlV2lkZ2V0Lm1vdXNlUG9pbnQueSA9IGUuY2xpZW50WTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5ncmlkQ29uZmlnLm1heEhlaWdodCAqIHRoaXMuZ3JpZENvbmZpZy5yb3dIZWlnaHQgKyB0aGlzLmdyaWRDb25maWcubWFyZ2luVG9wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLmhlaWdodCA9IHRoaXMuZ3JpZENvbmZpZy5taW5IZWlnaHQgKiB0aGlzLmdyaWRDb25maWcucm93SGVpZ2h0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYodGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUud2lkdGggKyBkeCAgPj0gdGhpcy5ncmlkQ29uZmlnLm1pbldpZHRoICogdGhpcy5ncmlkQ29uZmlnLmNvbFdpZHRoKXtcclxuICAgICAgICAgICAgaWYodGhpcy5ncmlkQ29uZmlnLm1heFdpZHRoID09IC0xIHx8IHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLndpZHRoICsgZHggPD0gdGhpcy5ncmlkQ29uZmlnLm1heFdpZHRoICogdGhpcy5ncmlkQ29uZmlnLmNvbFdpZHRoICsgdGhpcy5ncmlkQ29uZmlnLm1hcmdpbkxlZnQpe1xyXG4gICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS53aWR0aCArPSBkeDtcclxuICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVXaWRnZXQubW91c2VQb2ludC54ID0gZS5jbGllbnRYO1xyXG4gICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLndpZHRoID0gdGhpcy5ncmlkQ29uZmlnLm1heFdpZHRoICogdGhpcy5ncmlkQ29uZmlnLmNvbFdpZHRoICsgdGhpcy5ncmlkQ29uZmlnLm1hcmdpbkxlZnQ7XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUud2lkdGggPSB0aGlzLmdyaWRDb25maWcubWluV2lkdGggKiB0aGlzLmdyaWRDb25maWcuY29sV2lkdGg7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIH1cclxuXHJcbiAgQEhvc3RMaXN0ZW5lcignbW91c2V1cCcsIFsnJGV2ZW50J10pXHJcbiAgb25Nb3VzZVVwKGUpe1xyXG4gICAgaWYodGhpcy5hY3RpdmVXaWRnZXQpe1xyXG4gICAgICBpZih0aGlzLmFjdGl2ZVdpZGdldC5pc0RyYWcpe1xyXG4gICAgICAgIHRoaXMub25EcmFnU3RvcC5lbWl0KHRoaXMuYWN0aXZlV2lkZ2V0KTtcclxuICAgICAgICB0aGlzLmFjdGl2ZVdpZGdldC5zZXRQb3NpdGlvbih0aGlzLm5nV2lkZ2V0U2hhZG93LnBvc2l0aW9uKTtcclxuICAgICAgICB0aGlzLl9maW5kV2lkZ2V0QnlJZCh0aGlzLmFjdGl2ZVdpZGdldC5pZCkucG9zaXRpb24gPSB0aGlzLm5nV2lkZ2V0U2hhZG93LnBvc2l0aW9uO1xyXG4gICAgICAgIHRoaXMuX2NhbGNHcmlkU2l6ZSgpO1xyXG4gICAgICB9ZWxzZSBpZih0aGlzLmFjdGl2ZVdpZGdldC5pc1Jlc2l6ZSl7XHJcbiAgICAgICAgdGhpcy5vblJlc2l6ZVN0b3AuZW1pdCh0aGlzLmFjdGl2ZVdpZGdldCk7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVXaWRnZXQuc2V0U2l6ZSh0aGlzLm5nV2lkZ2V0U2hhZG93LnNpemUpO1xyXG4gICAgICAgIHRoaXMuX2ZpbmRXaWRnZXRCeUlkKHRoaXMuYWN0aXZlV2lkZ2V0LmlkKS5zaXplID0gdGhpcy5uZ1dpZGdldFNoYWRvdy5zaXplO1xyXG4gICAgICAgIHRoaXMuX2NhbGNHcmlkU2l6ZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubmdXaWRnZXRTaGFkb3cuZGVhY3RpdmF0ZSgpO1xyXG4gICAgICB0aGlzLmFjdGl2ZVdpZGdldC5yZXNldCgpO1xyXG4gICAgICB0aGlzLmFjdGl2ZVdpZGdldCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASG9zdExpc3RlbmVyKCd3aW5kb3c6c2Nyb2xsJyxbJyRldmVudCddKVxyXG4gIG9uU2Nyb2xsKGUpe1xyXG4gICAgaWYodGhpcy5hY3RpdmVXaWRnZXQpe1xyXG4gICAgICBpZih0aGlzLmFjdGl2ZVdpZGdldC5pc0RyYWcpe1xyXG4gICAgICAgIHZhciBkeCA9IHdpbmRvdy5zY3JvbGxYIC0gdGhpcy53aW5kb3dTY3JvbGwueDtcclxuICAgICAgICB2YXIgZHkgPSB3aW5kb3cuc2Nyb2xsWSAtIHRoaXMud2luZG93U2Nyb2xsLnk7XHJcbiAgICAgICAgbGV0IGdyaWRQb3MgPSB0aGlzLl9nZXRQb3NpdGlvbigpO1xyXG5cclxuICAgICAgICBpZih0aGlzLm5nV2lkZ2V0U2hhZG93LnBvc2l0aW9uLnJvdyAhPSBncmlkUG9zLnJvdyB8fCB0aGlzLm5nV2lkZ2V0U2hhZG93LnBvc2l0aW9uLmNvbCAhPSBncmlkUG9zLmNvbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrQ29sbGlzaW9uKGdyaWRQb3MsdGhpcy5hY3RpdmVXaWRnZXQuc2l6ZSx0aGlzLmFjdGl2ZVdpZGdldC5pZCk7XHJcbiAgICAgICAgICAgIHRoaXMubmdXaWRnZXRTaGFkb3cuc2V0UG9zaXRpb24oZ3JpZFBvcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbGNHcmlkU2l6ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS50b3AgPiAwIHx8IGR5ID4gMCl7XHJcbiAgICAgICAgICB0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS50b3AgPSB0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS50b3AgKyBkeSA+IDAgPyB0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS50b3AgKyBkeSA6IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLmxlZnQgPiAwIHx8IGR4ID4gMCl7XHJcbiAgICAgICAgICB0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS5sZWZ0ID0gdGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUubGVmdCArIGR4ID4gMCA/IHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLmxlZnQgKyBkeCA6IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLndpbmRvd1Njcm9sbC54ID0gd2luZG93LnNjcm9sbFg7XHJcbiAgICB0aGlzLndpbmRvd1Njcm9sbC55ID0gd2luZG93LnNjcm9sbFk7XHJcbiAgfVxyXG5cclxuICBvbkFjdGl2YXRlV2lkZ2V0KHdpZGdldDpOZ1dpZGdldCl7XHJcbiAgICBpZih3aWRnZXQuaXNEcmFnKXtcclxuICAgICAgdGhpcy5vbkRyYWdTdGFydC5lbWl0KHdpZGdldCk7XHJcbiAgICB9ZWxzZSBpZih3aWRnZXQuaXNSZXNpemUpe1xyXG4gICAgICB0aGlzLm9uUmVzaXplU3RhcnQuZW1pdCh3aWRnZXQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5uZ1dpZGdldFNoYWRvdy5hY3RpdmF0ZSgpO1xyXG4gICAgdGhpcy5uZ1dpZGdldFNoYWRvdy5zZXRQb3NpdGlvbih3aWRnZXQucG9zaXRpb24pO1xyXG4gICAgdGhpcy5uZ1dpZGdldFNoYWRvdy5zZXRTaXplKHdpZGdldC5zaXplKTtcclxuICAgIHRoaXMuYWN0aXZlV2lkZ2V0ID0gd2lkZ2V0O1xyXG4gIH1cclxuXHJcbiAgb25DbG9zZSh3aWRnZXQ6TmdXaWRnZXQpe1xyXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMud2lkZ2V0cy5sZW5ndGg7aSsrKXtcclxuICAgICAgaWYodGhpcy53aWRnZXRzW2ldLmlkID09IHdpZGdldC5pZCl7XHJcbiAgICAgICAgdGhpcy53aWRnZXRzLnNwbGljZShpLDEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhZGRXaWRnZXQoKTphbnl7XHJcblxyXG4gICAgZnVuY3Rpb24gZ3VpZCgpe1xyXG4gICAgICBmdW5jdGlvbiBzNCgpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGVtcHR5Q29sID0gdGhpcy5fZmluZEVtcHR5Q29sKCk7XHJcblxyXG4gICAgbGV0IG5ld1dpZGdldCA9IHtcclxuICAgICAgaWQ6IGd1aWQoKSxcclxuICAgICAgcG9zaXRpb246e1xyXG4gICAgICAgICdjb2wnOiBlbXB0eUNvbCxcclxuICAgICAgICAncm93JzogMVxyXG4gICAgICB9LFxyXG4gICAgICBzaXplOntcclxuICAgICAgICAneCc6MSxcclxuICAgICAgICAneSc6MVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy53aWRnZXRzLnB1c2gobmV3V2lkZ2V0KTtcclxuICAgIHRoaXMuX2NhbGNHcmlkU2l6ZSgpO1xyXG4gICAgcmV0dXJuIG5ld1dpZGdldDtcclxuICB9XHJcblxyXG4gIGVtcHR5KCl7XHJcbiAgICB0aGlzLndpZGdldHMgPSBbXTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2dldFBvc2l0aW9uKCl7XHJcbiAgICBsZXQgY29sID0gTWF0aC5yb3VuZCh0aGlzLmFjdGl2ZVdpZGdldC5zdHlsZS5sZWZ0IC8gKHRoaXMuZ3JpZENvbmZpZy5jb2xXaWR0aCArIHRoaXMuZ3JpZENvbmZpZy5tYXJnaW5MZWZ0LzIpKSsgMTtcclxuXHRcdGxldCByb3cgPSBNYXRoLnJvdW5kKHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLnRvcCAvICh0aGlzLmdyaWRDb25maWcucm93SGVpZ2h0ICsgdGhpcy5ncmlkQ29uZmlnLm1hcmdpblRvcC8yKSkgKyAxO1xyXG5cclxuICAgIHJldHVybiB7J2NvbCc6Y29sLCdyb3cnOnJvd307XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9nZXRTaXplKCl7XHJcbiAgICBsZXQgeCA9ICBNYXRoLnJvdW5kKHRoaXMuYWN0aXZlV2lkZ2V0LnN0eWxlLndpZHRoIC8gKHRoaXMuZ3JpZENvbmZpZy5jb2xXaWR0aCArIHRoaXMuZ3JpZENvbmZpZy5tYXJnaW5MZWZ0LzIpKTtcclxuICAgIGxldCB5ID0gIE1hdGgucm91bmQodGhpcy5hY3RpdmVXaWRnZXQuc3R5bGUuaGVpZ2h0IC8gKHRoaXMuZ3JpZENvbmZpZy5yb3dIZWlnaHQgKyB0aGlzLmdyaWRDb25maWcubWFyZ2luVG9wLzIpKTtcclxuXHJcbiAgICByZXR1cm4geyd4Jzp4LCd5Jzp5fTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2dldE1vdXNlUG9zaXRpb24oZSkge1xyXG5cdFx0Y29uc3QgcmVmUG9zOiBhbnkgPSB0aGlzLmdyaWQubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcblx0XHRsZXQgbGVmdDogbnVtYmVyID0gZS5jbGllbnRYIC0gcmVmUG9zLmxlZnQ7XHJcblx0XHRsZXQgdG9wOiBudW1iZXIgPSBlLmNsaWVudFkgLSByZWZQb3MudG9wO1xyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGxlZnQ6IGxlZnQsXHJcblx0XHRcdHRvcDogdG9wXHJcblx0XHR9O1xyXG5cdH1cclxuXHJcbiAgcHJpdmF0ZSBfZmluZE5nV2lkZ2V0QnlJZChpZCl7XHJcbiAgICBmb3IobGV0IGkgPSAwO2kgPCB0aGlzLm5nV2lkZ2V0cy5sZW5ndGg7aSsrKXtcclxuICAgICAgaWYodGhpcy5uZ1dpZGdldHNbaV0uaWQgPT0gaWQpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5nV2lkZ2V0c1tpXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfZmluZFdpZGdldEJ5SWQoaWQpe1xyXG4gICAgZm9yKGxldCBpID0gMDtpIDwgdGhpcy53aWRnZXRzLmxlbmd0aDtpKyspe1xyXG4gICAgICBpZih0aGlzLndpZGdldHNbaV0uaWQgPT0gaWQpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLndpZGdldHNbaV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2ZpbmRFbXB0eUNvbCgpe1xyXG4gICAgdmFyIGNvbCA9IDA7XHJcbiAgICB0aGlzLndpZGdldHMuZm9yRWFjaCgod2lkZ2V0KT0+e1xyXG4gICAgICBpZih3aWRnZXQucG9zaXRpb24uY29sID4gY29sKVxyXG4gICAgICAgIGNvbCA9IHdpZGdldC5wb3NpdGlvbi5jb2w7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBjb2wrMTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2dldENvbGxpc2lvbihwb3NpdGlvbixzaXplLGlkKXtcclxuICAgIHZhciBjb2xsaXNpb25zPVtdO1xyXG4gICAgdGhpcy5uZ1dpZGdldHMuZm9yRWFjaCgod2lkZ2V0KT0+e1xyXG4gICAgICAgIGlmKHdpZGdldC5pZCAhPSBpZCAmJiB3aWRnZXQuaWQgIT0gdGhpcy5hY3RpdmVXaWRnZXQuaWQpe1xyXG4gICAgICAgICAgaWYoKCh3aWRnZXQucG9zaXRpb24uY29sID49IHBvc2l0aW9uLmNvbCAmJiB3aWRnZXQucG9zaXRpb24uY29sIDwgcG9zaXRpb24uY29sICsgc2l6ZS54KVxyXG4gICAgICAgICAgfHwgKHdpZGdldC5wb3NpdGlvbi5jb2wgKyB3aWRnZXQuc2l6ZS54LTEgPj0gcG9zaXRpb24uY29sICYmIHdpZGdldC5wb3NpdGlvbi5jb2wgKyB3aWRnZXQuc2l6ZS54LTEgPCBwb3NpdGlvbi5jb2wgKyBzaXplLngpXHJcbiAgICAgICAgfHwgKHBvc2l0aW9uLmNvbCA+PSB3aWRnZXQucG9zaXRpb24uY29sICYmIHBvc2l0aW9uLmNvbCA8IHdpZGdldC5wb3NpdGlvbi5jb2wgKyB3aWRnZXQuc2l6ZS54KSlcclxuICAgICAgICAmJiAoKHdpZGdldC5wb3NpdGlvbi5yb3cgPj0gcG9zaXRpb24ucm93ICYmIHdpZGdldC5wb3NpdGlvbi5yb3cgPCBwb3NpdGlvbi5yb3cgKyBzaXplLnkpXHJcbiAgICAgIHx8ICh3aWRnZXQucG9zaXRpb24ucm93ICsgd2lkZ2V0LnNpemUueS0xID49IHBvc2l0aW9uLnJvdyAmJiB3aWRnZXQucG9zaXRpb24ucm93ICsgd2lkZ2V0LnNpemUueS0xIDwgcG9zaXRpb24ucm93ICsgc2l6ZS55KVxyXG4gICAgfHwgKHBvc2l0aW9uLnJvdyA+PSB3aWRnZXQucG9zaXRpb24ucm93ICYmIHBvc2l0aW9uLnJvdyA8IHdpZGdldC5wb3NpdGlvbi5yb3cgKyB3aWRnZXQuc2l6ZS55KSkpe1xyXG4gICAgICAgICAgICAgIGNvbGxpc2lvbnMucHVzaCh3aWRnZXQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGNvbGxpc2lvbnM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9jaGVja0NvbGxpc2lvbihwb3NpdGlvbixzaXplLGlkKXtcclxuICAgIHZhciBjb2xsaXNpb25zID0gdGhpcy5fZ2V0Q29sbGlzaW9uKHBvc2l0aW9uLHNpemUsaWQpO1xyXG4gICAgY29sbGlzaW9ucy5mb3JFYWNoKCh3aWRnZXQpPT57XHJcbiAgICAgIHdpZGdldC5wb3NpdGlvbi5yb3cgPSBwb3NpdGlvbi5yb3cgKyBzaXplLnk7XHJcbiAgICAgIHdpZGdldC5jYWxjUG9zaXRpb24oKTtcclxuICAgICAgdGhpcy5fY2hlY2tDb2xsaXNpb24od2lkZ2V0LnBvc2l0aW9uLHdpZGdldC5zaXplLHdpZGdldC5pZCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2NhbGNHcmlkU2l6ZSgpe1xyXG4gICAgdmFyIG1heFJvdyA9IHRoaXMuZ3JpZENvbmZpZy5tYXhSb3c7XHJcbiAgICB2YXIgbWF4Q29sID0gdGhpcy5ncmlkQ29uZmlnLm1heENvbDtcclxuICAgIHRoaXMud2lkZ2V0cy5mb3JFYWNoKCh3aWRnZXQpPT57XHJcbiAgICAgICAgICBpZiggKHdpZGdldC5wb3NpdGlvbi5jb2wgKyB3aWRnZXQuc2l6ZS54IC0gMSkgPiBtYXhDb2wgKVxyXG4gICAgICAgICAgICBtYXhDb2wgPSB3aWRnZXQucG9zaXRpb24uY29sICsgd2lkZ2V0LnNpemUueCAtIDE7XHJcbiAgICAgICAgICBpZigod2lkZ2V0LnBvc2l0aW9uLnJvdyArIHdpZGdldC5zaXplLnkgLTEpID4gbWF4Um93KVxyXG4gICAgICAgICAgICBtYXhSb3cgPSB3aWRnZXQucG9zaXRpb24ucm93ICsgd2lkZ2V0LnNpemUueSAtMTtcclxuICAgIH0pO1xyXG4gICAgaWYoKHRoaXMubmdXaWRnZXRTaGFkb3cucG9zaXRpb24uY29sICsgdGhpcy5uZ1dpZGdldFNoYWRvdy5zaXplLnggLSAxKSA+IG1heENvbCApXHJcbiAgICAgIG1heENvbCA9IHRoaXMubmdXaWRnZXRTaGFkb3cucG9zaXRpb24uY29sICsgdGhpcy5uZ1dpZGdldFNoYWRvdy5zaXplLnggLSAxO1xyXG4gICAgaWYoKHRoaXMubmdXaWRnZXRTaGFkb3cucG9zaXRpb24ucm93ICsgdGhpcy5uZ1dpZGdldFNoYWRvdy5zaXplLnkgLTEpID4gbWF4Um93KVxyXG4gICAgICBtYXhSb3cgPSB0aGlzLm5nV2lkZ2V0U2hhZG93LnBvc2l0aW9uLnJvdyArIHRoaXMubmdXaWRnZXRTaGFkb3cuc2l6ZS55IC0xO1xyXG4gICAgdGhpcy5ncmlkU3R5bGUud2lkdGggPSAobWF4Q29sICogKHRoaXMuZ3JpZENvbmZpZy5jb2xXaWR0aCsyKSkgKyAobWF4Q29sICogdGhpcy5ncmlkQ29uZmlnLm1hcmdpbkxlZnQpXHJcbiAgICArIHRoaXMuZ3JpZENvbmZpZy5tYXJnaW5SaWdodDtcclxuICAgIHRoaXMuZ3JpZFN0eWxlLmhlaWdodCA9IChtYXhSb3cgKiAodGhpcy5ncmlkQ29uZmlnLnJvd0hlaWdodCsyKSkgKyAobWF4Um93ICogdGhpcy5ncmlkQ29uZmlnLm1hcmdpblRvcClcclxuICAgICsgdGhpcy5ncmlkQ29uZmlnLm1hcmdpbkJvdHRvbTtcclxuICB9XHJcblxyXG59XHJcbiJdfQ==
